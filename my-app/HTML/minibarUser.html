<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MINIBAR</title>
    <link rel="shortcut icon" href="/IMAGENES/iconSena.png">
    <link rel="stylesheet" href="/CSS/minibar.css">
</head>
<body style="padding-bottom: 0px;">
    <!--todo este es el encabezado -->
    <div class="app-container">
        <div class="app-header">
            <div class="app-header-left">
                <button class="navbar-toggle" id="navbar-toggle" title="Toggle Navbar">
                    <svg fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="24" height="24" viewBox="0 0 24 24">
                        <path d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
                <a href="https://oferta.senasofiaplus.edu.co/sofia-oferta/" target="_blank">
                    <img src="/IMAGENES/iconSena.png" style="height: 50px; border-radius: 20px" alt="icono sena">
                </a>
                <p class="app-name">SENA DREAM</p>
            </div>
            <div class="app-header-right">
                <button class="mode-switch" title="Switch Theme">
                    <svg class="moon" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="24" height="24" viewBox="0 0 24 24">
                        <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
                </button>
                <div class="profile-container">
                    <button class="profile-btn" id="profile-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-person" viewBox="0 0 24 24">
                            <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zM12 14c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                        </svg>
                        <span id="nombre-usuario">Usuario</span>
                        <svg id="chevron-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-down" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
                        </svg>
                    </button>
                    <ul class="profile-dropdown" id="profile-dropdown">
                        <li><a href="/index.html" onclick="cerrarSesion()">Cerrar Sesión</a></li>
                    </ul>
                    <script>
                        document.getElementById('profile-btn').addEventListener('click', function() {
                            var dropdown = document.getElementById('profile-dropdown');
                            dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
                        });
                    </script>
                </div>
            </div>
        </div>
        <!--Aqui es el iconos de navegar-->
        <div class="app-content">
            <div class="app-sidebar" id="app-sidebar">
                <a href="/HTML/menuUser.html" class="app-sidebar-link">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-home">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                        <polyline points="9 22 9 12 15 12 15 22" /></svg>
                </a>
                <!--Aqui es el icono de la persona-->
                <a href="/HTML/huespedUser.html" class=app-sidebar-link>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-person" viewBox="0 0 24 24">
                        <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zM12 14c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                    </svg>
                </a>
                <!--Aqui es el icono de la habitaciones-->
                <a href="/HTML/habitacionesUser.html" class="app-sidebar-link">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-bed">
                        <path d="M3 7h18v10H3z" />
                        <path d="M3 7v10" />
                        <path d="M21 7v10" />
                        <path d="M3 12h18" />
                        <path d="M7 7v5" />
                        <path d="M17 7v5" />
                    </svg>
                </a>
                <!--Aqui es el icono de la tareas-->
                <a href="/HTML/tareasUser.html" class="app-sidebar-link ">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                        <line x1="16" y1="2" x2="16" y2="6" />
                        <line x1="8" y1="2" x2="8" y2="6" />
                        <line x1="3" y1="10" x2="21" y2="10" /></svg>
                </a>
                <a href="" class="app-sidebar-link active">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-glass">
                        <path d="M21 2H3"></path>
                        <path d="M17 2l-2 14H9L7 2"></path>
                        <path d="M9 22h6"></path>
                    </svg>
                </a>
                <!--Aqui es el icono de la cuenta-->
                <a href="/HTML/cuentaUser.html" class="app-sidebar-link">
                    <svg class="link-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="feather feather-file-text" viewBox="0 0 24 24">
                        <defs />
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                        <polyline points="14 2 14 8 20 8" />
                        <line x1="16" y1="13" x2="8" y2="13" />
                        <line x1="16" y1="17" x2="8" y2="17" />
                        <polyline points="10 9 9 9 8 9" />
                    </svg>
                </a>
            </div>
            <!--Ya empieza todo dentro de los el menu-->
            <div class="projects-section scrollable">
                <div class="projects-section-header">
                    <p>MINIBAR</p>
                </div>
                <!-- Agrega el info-cards aquí -->
                <div class="info-cards">
                    <div class="info-card large">
                        <button class="add-product-btn" id="openModalBtn" style="font-size: 1.2em; padding: 10px 20px; display: block; margin: 0 auto; background-color: #4CAF50;">Agregar productos</button>
                    </div>
                    <div class="info-card large">
                        <div class="search-container">
                            <button class="search-btn" id="searchBtn">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                                    <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001l3.85 3.85a1 1 0 0 0 1.415-1.415l-3.85-3.85zm-5.442 1.398a5.5 5.5 0 1 1 0-11 5.5 5.5 0 0 1 0 11z"/>
                                </svg>
                            </button>
                            <select class="search-select" id="searchRef">
                                <option value="">Seleccionar</option>
                                <option value="todos">Todos</option>
                                <option value="bebidas-energeticas">Bebidas energéticas</option>
                                <option value="galletas">Galletas</option>
                                <option value="golosinas">Golosinas</option>
                                <option value="snaks">Snaks</option>
                                <option value="gaseosas">Gaseosas</option>
                                <option value="paqueteria">Paquetería</option>
                            </select>
                            <input type="text" class="search-input" id="searchName" placeholder="Buscar por nombre">
                        </div>
                    </div>
                </div>
                <div id="productCards" class="info-cards">
                    <!-- Aquí se agregarán los productos dinámicamente -->
                    <!-- Ejemplo de producto con mayor tamaño y legibilidad -->
                    <div class="product-card" style="font-size: 1.5em; padding: 20px; border: 1px solid #ccc; margin-bottom: 15px; border-radius: 10px; background-color: #f9f9f9;">
                        <p><strong>Nombre:</strong> Producto Ejemplo</p>
                        <p><strong>Referencia:</strong> Galletas</p>
                        <p><strong>Precio:</strong> $10.00</p>
                        <p><strong>Cantidad:</strong> 5</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeModalBtn">&times;</span>
            <h2>Agregar Producto</h2>
            <form id="productForm">
                <label for="productName">Nombre del producto:</label>
                <input type="text" id="productName" name="productName" required>
                
                <label for="productRef">Referencia:</label>
                <select id="productRef" name="productRef" required>
                    <option value="bebidas-energeticas">Bebidas energéticas</option>
                    <option value="galletas">Galletas</option>
                    <option value="golosinas">Golosinas</option>
                    <option value="snaks">Snaks</option>
                    <option value="gaseosas">Gaseosas</option>
                    <option value="paqueteria">Paquetería</option>
                </select>
                
                <label for="productPrice">Precio:</label>
                <input type="number" id="productPrice" name="productPrice" required>
                
                <label for="productQuantity">Cantidad:</label>
                <input type="number" id="productQuantity" name="productQuantity" required>
                
                <button type="submit" class="add-product-btn">Agregar producto</button>
            </form>
            <div id="formMessage" style="margin-top: 10px;"></div> <!-- Mensaje de estado -->
        </div>
    </div>

    <!-- Modal para asignar/desasignar productos a habitaciones -->
    <div id="assignProductModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeAssignModalBtn">&times;</span>
            <h2 id="modalTitle">Asignar Producto a Habitación</h2> <!-- Cambiar dinámicamente el título -->
            <form id="assignProductForm">
                <label for="roomNumber">Número de Habitación:</label>
                <select id="roomNumber" name="roomNumber" required>
                    <!-- Las opciones se llenarán dinámicamente -->
                </select>
                
                <label for="assignQuantity">Cantidad:</label>
                <input type="number" id="assignQuantity" name="assignQuantity" required>
                
                <button type="submit" class="add-product-btn" id="modalSubmitButton">Asignar</button> <!-- Cambiar dinámicamente el texto -->
            </form>
            <div id="assignFormMessage" style="margin-top: 10px;"></div> <!-- Mensaje de estado -->
        </div>
    </div>

    <!-- Modal para desasignar productos de habitaciones -->
    <div id="unassignProductModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeUnassignModalBtn">&times;</span>
            <h2>Desasignar Producto de Habitación</h2>
            <form id="unassignProductForm">
                <label for="unassignRoomNumber">Número de Habitación:</label>
                <select id="unassignRoomNumber" name="unassignRoomNumber" required>
                    <!-- Las opciones se llenarán dinámicamente -->
                </select>
                
                <label for="unassignQuantity">Cantidad:</label>
                <input type="number" id="unassignQuantity" name="unassignQuantity" required>
                
                <button type="submit" class="add-product-btn">Desasignar</button>
            </form>
            <div id="unassignFormMessage" style="margin-top: 10px;"></div> <!-- Mensaje de estado -->
        </div>
    </div>
    <script>
        // Alternar entre modo oscuro y claro
        document.querySelector('.mode-switch').addEventListener('click', function() {
            document.body.classList.toggle('dark-mode');
            document.body.classList.toggle('light-mode');
        });

        // Alternar visibilidad de la barra de navegación
        document.getElementById('navbar-toggle').addEventListener('click', function() {
            var sidebar = document.getElementById('app-sidebar');
            sidebar.classList.toggle('hidden');
        });

        // Cargar productos al cargar la página
        document.addEventListener('DOMContentLoaded', function() {
            loadProducts();
        });

        // Manejar la búsqueda de productos
        document.getElementById('searchBtn').addEventListener('click', function() {
            searchProducts();
        });
function openEditModal(productId) {
    const editModal = document.getElementById('productModal');
    editModal.style.display = 'block';

    // Hacer una solicitud al backend para obtener los datos del producto
    fetch(`/api/productos/${productId}`)
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
        })
        .then(product => {
            // Llenar el formulario del modal con los datos del producto
            document.getElementById('productName').value = product.nombre;
            document.getElementById('productRef').value = product.referencia;
            document.getElementById('productPrice').value = product.precio;
            document.getElementById('productQuantity').value = product.cantidad;

            // Configurar el atributo data-product-id en el formulario
            document.getElementById('productForm').setAttribute('data-product-id', productId);

            // Cambiar el evento de envío del formulario para actualizar el producto
            document.getElementById('productForm').onsubmit = function (event) {
                event.preventDefault();
                updateProduct(productId);
            };
        })
        .catch(error => {
            console.error('Error al cargar los datos del producto:', error);
        });
}


        function cerrarSesion() {
            localStorage.removeItem('nombreUsuario');
        }
        document.addEventListener('DOMContentLoaded', () => {
            const nombreUsuario = localStorage.getItem('nombreUsuario');
            if (nombreUsuario) {
                document.getElementById('nombre-usuario').textContent = nombreUsuario;
            }
        });
        // Exponer la función al ámbito global
window.openEditModal = openEditModal;
    </script>
</body>
</html>